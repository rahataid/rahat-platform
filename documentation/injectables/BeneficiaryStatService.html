<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>@rahat-os/source documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">@rahat-os/source documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">








<ol class="breadcrumb">
  <li class="breadcrumb-item">Injectables</li>
  <li class="breadcrumb-item" >BeneficiaryStatService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts</code>
        </p>





            <section data-compodoc="block-index">
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculateAgeStats" >calculateAgeStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculateAllStats" >calculateAllStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculateBankedStatusStats" >calculateBankedStatusStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculateBankedStatusStatsNew" >calculateBankedStatusStatsNew</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculateCountByCasteStats" >calculateCountByCasteStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculateExtrasStats" >calculateExtrasStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculateGenderStats" >calculateGenderStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculateInternetStatusStats" >calculateInternetStatusStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculateMapStats" >calculateMapStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculatePhoneAvailabilityStats" >calculatePhoneAvailabilityStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculatePhoneStatusStats" >calculatePhoneStatusStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculatePhoneTypeStats" >calculatePhoneTypeStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculateProjectStats" >calculateProjectStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculateRangedAge" >calculateRangedAge</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#calculateVulnerabilityCountStats" >calculateVulnerabilityCountStats</a>
                            </li>
                            <li>
                                <a href="#countByCaste" >countByCaste</a>
                            </li>
                            <li>
                                <a href="#filterAndCountPhoneStatus" >filterAndCountPhoneStatus</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getAllStats" >getAllStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getTableStats" >getTableStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getTotalVoucher" >getTotalVoucher</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#saveAllStats" >saveAllStats</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#totalBeneficiaries" >totalBeneficiaries</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#totalVendors" >totalVendors</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section data-compodoc="block-constructor">
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(prisma: PrismaService, statsService: <a href="../injectables/StatsService.html" target="_self">StatsService</a>, client: <a href="../strings/Client.html" target="_self">ClientProxy</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="21" class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:21</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>prisma</td>
                                                  
                                                        <td>
                                                                    <code>PrismaService</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>statsService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/StatsService.html" target="_self" >StatsService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>client</td>
                                                  
                                                        <td>
                                                                        <code><a href="../miscellaneous/variables.html#Client" target="_self" >ClientProxy</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section data-compodoc="block-methods">
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculateAgeStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculateAgeStats</b></span>
                        <a href="#calculateAgeStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculateAgeStats(projectUuid?: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="72"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:72</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>projectUuid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    Yes
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculateAllStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculateAllStats</b></span>
                        <a href="#calculateAllStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculateAllStats()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="463"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:463</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculateBankedStatusStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculateBankedStatusStats</b></span>
                        <a href="#calculateBankedStatusStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculateBankedStatusStats(projectUuid?: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="111"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:111</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>projectUuid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    Yes
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculateBankedStatusStatsNew"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculateBankedStatusStatsNew</b></span>
                        <a href="#calculateBankedStatusStatsNew"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculateBankedStatusStatsNew()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="149"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:149</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculateCountByCasteStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculateCountByCasteStats</b></span>
                        <a href="#calculateCountByCasteStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculateCountByCasteStats()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="439"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:439</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculateExtrasStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculateExtrasStats</b></span>
                        <a href="#calculateExtrasStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculateExtrasStats(fieldName: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="384"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:384</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>fieldName</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculateGenderStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculateGenderStats</b></span>
                        <a href="#calculateGenderStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculateGenderStats(projectUuid?: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="33"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:33</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>projectUuid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    Yes
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculateInternetStatusStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculateInternetStatusStats</b></span>
                        <a href="#calculateInternetStatusStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculateInternetStatusStats(projectUuid?: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="197"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:197</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>projectUuid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    Yes
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculateMapStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculateMapStats</b></span>
                        <a href="#calculateMapStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculateMapStats()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="343"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:343</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculatePhoneAvailabilityStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculatePhoneAvailabilityStats</b></span>
                        <a href="#calculatePhoneAvailabilityStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculatePhoneAvailabilityStats()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="409"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:409</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculatePhoneStatusStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculatePhoneStatusStats</b></span>
                        <a href="#calculatePhoneStatusStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculatePhoneStatusStats(projectUuid?: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="236"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:236</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>projectUuid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    Yes
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculatePhoneTypeStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculatePhoneTypeStats</b></span>
                        <a href="#calculatePhoneTypeStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculatePhoneTypeStats()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="380"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:380</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculateProjectStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculateProjectStats</b></span>
                        <a href="#calculateProjectStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculateProjectStats(projectUuid: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="511"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:511</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>projectUuid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculateRangedAge"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculateRangedAge</b></span>
                        <a href="#calculateRangedAge"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculateRangedAge(ages: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="543"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:543</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>ages</td>
                                            <td>
                                                            <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calculateVulnerabilityCountStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>calculateVulnerabilityCountStats</b></span>
                        <a href="#calculateVulnerabilityCountStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>calculateVulnerabilityCountStats()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="415"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:415</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="countByCaste"></a>
                    <span class="name">
                        <span ><b>countByCaste</b></span>
                        <a href="#countByCaste"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>countByCaste(array)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="426"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:426</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>array</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="filterAndCountPhoneStatus"></a>
                    <span class="name">
                        <span ><b>filterAndCountPhoneStatus</b></span>
                        <a href="#filterAndCountPhoneStatus"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>filterAndCountPhoneStatus(data)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="361"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:361</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>{}</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getAllStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getAllStats</b></span>
                        <a href="#getAllStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getAllStats(group: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="536"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:536</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                                <td>Default value</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>group</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>

                                            <td>
                                                    <code>&#x27;beneficiary&#x27;</code>
                                            </td>

                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getTableStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getTableStats</b></span>
                        <a href="#getTableStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getTableStats()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="28"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:28</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getTotalVoucher"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getTotalVoucher</b></span>
                        <a href="#getTotalVoucher"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getTotalVoucher()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="331"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:331</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="saveAllStats"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>saveAllStats</b></span>
                        <a href="#saveAllStats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>saveAllStats(projectUuid?: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="568"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:568</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>projectUuid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    Yes
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="totalBeneficiaries"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>totalBeneficiaries</b></span>
                        <a href="#totalBeneficiaries"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>totalBeneficiaries(projectUuid?: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="274"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:274</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>projectUuid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    Yes
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="totalVendors"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>totalVendors</b></span>
                        <a href="#totalVendors"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>totalVendors(projectUuid?: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="301"
                                    class="link-to-prism">apps/beneficiary/src/beneficiary/beneficiaryStat.service.ts:301</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>projectUuid</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    Yes
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Inject, Injectable } from &#x27;@nestjs/common&#x27;;
import { ClientProxy } from &#x27;@nestjs/microservices&#x27;;
import { StatsService } from &#x27;@rahat/stats&#x27;;
import { MS_TIMEOUT, ProjectContants } from &#x27;@rahataid/sdk&#x27;;
import { SettingsService } from &#x27;@rumsan/extensions/settings&#x27;;
import { PrismaService } from &#x27;@rumsan/prisma&#x27;;
import { timeout } from &#x27;rxjs&#x27;;
import { hasKey } from &#x27;../utils/objectUtil&#x27;;
import { RahatTokenAbi } from &#x27;../utils/rahatToken&#x27;;
import { mapVulnerabilityStatusCount } from &#x27;../utils/vulnerabilityCountHelpers&#x27;;
import { createContractReader } from &#x27;../utils/web3&#x27;;

const REPORTING_FIELD &#x3D; {
  FAMILY_MEMBER_BANK_ACCOUNT: &quot;is_there_any_family_member_who_has_an_active_bank_account&quot;,
  TYPE_OF_PHONE_SET: &quot;type_of_phone_set&quot;
}



@Injectable()
export class BeneficiaryStatService {
  constructor(
    protected prisma: PrismaService,
    private readonly statsService: StatsService,
    @Inject(ProjectContants.ELClient) private readonly client: ClientProxy
  ) { }

  async getTableStats() {
    return await this.prisma.stats.findMany({});
  }


  async calculateGenderStats(projectUuid?: string) {
    let filter &#x3D; {};

    // Add filter if projectUuid is provided
    if (projectUuid) {
      const beneficiaryId &#x3D; await this.prisma.beneficiaryProject
        .findMany({
          where: {
            projectId: projectUuid,
          },
          select: {
            beneficiaryId: true,
          },
        })
        .then((projectBen) &#x3D;&gt;
          projectBen.map((data: any) &#x3D;&gt; data?.beneficiaryId)
        );

      filter &#x3D; {
        uuid: {
          in: beneficiaryId || [],
        },
      };
    }

    const genderStats &#x3D; await this.prisma.beneficiary.groupBy({
      by: [&#x27;gender&#x27;],
      _count: {
        gender: true,
      },
      where: filter,
    });

    return genderStats.map((stat) &#x3D;&gt; ({
      id: stat.gender,
      count: stat._count.gender,
    }));
  }

  async calculateAgeStats(projectUuid?: string) {
    let filter &#x3D; {};

    // Add filter if projectUuid is provided
    if (projectUuid) {
      const beneficiaryId &#x3D; await this.prisma.beneficiaryProject
        .findMany({
          where: {
            projectId: projectUuid,
          },
          select: {
            beneficiaryId: true,
          },
        })
        .then((projectBen) &#x3D;&gt;
          projectBen.map((data: any) &#x3D;&gt; data?.beneficiaryId)
        );

      filter &#x3D; {
        uuid: {
          in: beneficiaryId || [],
        },
      };
    }

    const ageStats &#x3D; await this.prisma.beneficiary.groupBy({
      by: [&#x27;age&#x27;],
      _count: {
        age: true,
      },
      where: filter,
    });

    return ageStats.map((stat) &#x3D;&gt; ({
      id: stat.age,
      count: stat._count.age,
    }));
  }

  async calculateBankedStatusStats(projectUuid?: string) {
    let filter &#x3D; {};

    // Add filter if projectUuid is provided
    if (projectUuid) {
      const beneficiaryId &#x3D; await this.prisma.beneficiaryProject
        .findMany({
          where: {
            projectId: projectUuid,
          },
          select: {
            beneficiaryId: true,
          },
        })
        .then((projectBen) &#x3D;&gt;
          projectBen.map((data: any) &#x3D;&gt; data?.beneficiaryId)
        );

      filter &#x3D; {
        uuid: {
          in: beneficiaryId || [],
        },
      };
    }
    const bankedStatusStats &#x3D; await this.prisma.beneficiary.groupBy({
      by: [&#x27;bankedStatus&#x27;],
      _count: {
        bankedStatus: true,
      },
      where: filter,
    });

    return bankedStatusStats.map((stat) &#x3D;&gt; ({
      id: stat.bankedStatus,
      count: stat._count.bankedStatus,
    }));
  }

  async calculateBankedStatusStatsNew() {
    const data &#x3D; await this.prisma.beneficiary.findMany({
      where: { deletedAt: null },
      select: {
        extras: true
      }
    });

    let myData &#x3D; {};


    for (let d of data) {
      const extras &#x3D; d?.extras ?? null;
      if (
        extras &amp;&amp;
        hasKey(extras, REPORTING_FIELD.FAMILY_MEMBER_BANK_ACCOUNT) &amp;&amp;
        typeof extras[REPORTING_FIELD.FAMILY_MEMBER_BANK_ACCOUNT] &#x3D;&#x3D;&#x3D; &#x27;string&#x27; &amp;&amp;
        extras[REPORTING_FIELD.FAMILY_MEMBER_BANK_ACCOUNT]
          .toUpperCase()
          .trim() &#x3D;&#x3D;&#x3D; &#x27;YES&#x27;
      ) {
        if (myData[&#x27;Banked&#x27;]) {
          myData[&#x27;Banked&#x27;] +&#x3D; 1;
        } else myData[&#x27;Banked&#x27;] &#x3D; 1;
      }
      if (
        extras &amp;&amp;
        extras &amp;&amp;
        hasKey(extras, REPORTING_FIELD.FAMILY_MEMBER_BANK_ACCOUNT) &amp;&amp;
        typeof extras[REPORTING_FIELD.FAMILY_MEMBER_BANK_ACCOUNT] &#x3D;&#x3D;&#x3D; &#x27;string&#x27; &amp;&amp;
        extras[REPORTING_FIELD.FAMILY_MEMBER_BANK_ACCOUNT]
          .toUpperCase()
          .trim() &#x3D;&#x3D;&#x3D; &#x27;NO&#x27;
      ) {
        if (myData[&#x27;UnBanked&#x27;]) {
          myData[&#x27;UnBanked&#x27;] +&#x3D; 1;
        } else myData[&#x27;UnBanked&#x27;] &#x3D; 1;
      }
    }

    const result &#x3D; Object.keys(myData).map((d) &#x3D;&gt; ({
      id: d,
      count: myData[d],
    }));

    return result;
  };

  async calculateInternetStatusStats(projectUuid?: string) {
    let filter &#x3D; {};

    // Add filter if projectUuid is provided
    if (projectUuid) {
      const beneficiaryId &#x3D; await this.prisma.beneficiaryProject
        .findMany({
          where: {
            projectId: projectUuid,
          },
          select: {
            beneficiaryId: true,
          },
        })
        .then((projectBen) &#x3D;&gt;
          projectBen.map((data: any) &#x3D;&gt; data?.beneficiaryId)
        );

      filter &#x3D; {
        uuid: {
          in: beneficiaryId || [],
        },
      };
    }

    const internetStatusStats &#x3D; await this.prisma.beneficiary.groupBy({
      by: [&#x27;internetStatus&#x27;],
      _count: {
        internetStatus: true,
      },
      where: filter,
    });

    return internetStatusStats.map((stat) &#x3D;&gt; ({
      id: stat.internetStatus,
      count: stat._count.internetStatus,
    }));
  }

  async calculatePhoneStatusStats(projectUuid?: string) {
    let filter &#x3D; {};

    // Add filter if projectUuid is provided
    if (projectUuid) {
      const beneficiaryId &#x3D; await this.prisma.beneficiaryProject
        .findMany({
          where: {
            projectId: projectUuid,
          },
          select: {
            beneficiaryId: true,
          },
        })
        .then((projectBen) &#x3D;&gt;
          projectBen.map((data: any) &#x3D;&gt; data?.beneficiaryId)
        );

      filter &#x3D; {
        uuid: {
          in: beneficiaryId || [],
        },
      };
    }
    const phoneStatusStats &#x3D; await this.prisma.beneficiary.groupBy({
      by: [&#x27;phoneStatus&#x27;],
      _count: {
        phoneStatus: true,
      },
      where: filter,
    });

    return phoneStatusStats.map((stat) &#x3D;&gt; ({
      id: stat.phoneStatus,
      count: stat._count.phoneStatus,
    }));
  }

  async totalBeneficiaries(projectUuid?: string) {
    let filter &#x3D; {};

    // Add filter if projectUuid is provided
    if (projectUuid) {
      const beneficiaryId &#x3D; await this.prisma.beneficiaryProject
        .findMany({
          where: {
            projectId: projectUuid,
          },
          select: {
            beneficiaryId: true,
          },
        })
        .then((projectBen) &#x3D;&gt;
          projectBen.map((data: any) &#x3D;&gt; data?.beneficiaryId)
        );

      filter &#x3D; {
        uuid: {
          in: beneficiaryId || [],
        },
      };
    }
    return { count: await this.prisma.beneficiary.count({ where: filter }) };
  }

  async totalVendors(projectUuid?: string) {
    let filter &#x3D; {};

    // Add filter if projectUuid is provided
    if (projectUuid) {
      const vendorId &#x3D; await this.prisma.projectVendors
        .findMany({
          where: {
            projectId: projectUuid,
          },
          select: {
            vendorId: true,
          },
        })
        .then((projectVen) &#x3D;&gt;
          projectVen.map((data: any) &#x3D;&gt; data?.vendorId)
        );

      filter &#x3D; {
        uuid: {
          in: vendorId || [],
        },
      };

    }

    // Todo: Calculate total
    return { count: await this.prisma.user.count({ where: filter }) };
  }

  async getTotalVoucher() {

    const settings &#x3D; new SettingsService(this.prisma);
    const contractSettings &#x3D; await settings.getByName(&#x27;CONTRACTS&#x27;)

    const rahatTokenAddress &#x3D; contractSettings.value[&#x27;RAHATTOKEN&#x27;].ADDRESS;

    const tokenContract &#x3D; await createContractReader(RahatTokenAbi, rahatTokenAddress)

    return tokenContract.totalSupply();
  }

  async calculateMapStats() {
    const beneficiaries &#x3D; await this.prisma.beneficiary.findMany({
      where: {
        deletedAt: null,
        latitude: { not: null },
        longitude: { not: null },
      },
      include: { pii: true },
    });
    const data &#x3D; beneficiaries?.map((b) &#x3D;&gt; ({
      name: b.pii.name,
      latitude: b.latitude,
      longitude: b.longitude,
    }));

    return data;
  }

  filterAndCountPhoneStatus(data) {
    let unPhonedCount &#x3D; 0;
    let phonedCount &#x3D; 0;

    data.forEach((record) &#x3D;&gt; {
      const phoneNumber &#x3D; record.phone;
      if (phoneNumber.startsWith(&#x27;999&#x27;)) {
        unPhonedCount +&#x3D; 1;
      } else {
        phonedCount +&#x3D; 1;
      }
    });

    return [
      { id: &#x27;Phoned&#x27;, count: phonedCount },
      { id: &#x27;UnPhoned&#x27;, count: unPhonedCount },
    ];
  }

  async calculatePhoneTypeStats() {
    return await this.calculateExtrasStats(REPORTING_FIELD.TYPE_OF_PHONE_SET)
  }

  async calculateExtrasStats(fieldName: string) {
    const data &#x3D; await this.prisma.beneficiary.findMany({
      where: {
        extras: { path: [fieldName], not: null },
      },
      select: { extras: true },
    });
    if (!data) return [];
    const myData &#x3D; {};
    // Calculate count for each value
    data.forEach((item: any) &#x3D;&gt; {
      const value &#x3D; item.extras[fieldName];
      if (myData[value]) {
        myData[value] +&#x3D; 1;
      } else {
        myData[value] &#x3D; 1;
      }
    });
    const result &#x3D; Object.keys(myData).map((d) &#x3D;&gt; ({
      id: d,
      count: myData[d],
    }));
    return result.filter((f) &#x3D;&gt; f.id.toLocaleUpperCase() !&#x3D;&#x3D; &#x27;NO&#x27;);
  }

  async calculatePhoneAvailabilityStats() {
    const results &#x3D; await this.prisma.beneficiaryPii.findMany({});
    const finalResult &#x3D; this.filterAndCountPhoneStatus(results);
    return finalResult;
  }

  async calculateVulnerabilityCountStats() {
    const benef &#x3D; await this.prisma.beneficiary.findMany({
      where: { deletedAt: null },
    });
    const myData &#x3D; mapVulnerabilityStatusCount(benef);
    return Object.keys(myData).map((d) &#x3D;&gt; ({
      id: d,
      count: myData[d],
    }));
  }

  countByCaste(array) {
    return array.reduce((result, currentValue) &#x3D;&gt; {
      const casteValue &#x3D; currentValue.extras.caste;
      if (casteValue) {
        if (!result[casteValue]) {
          result[casteValue] &#x3D; 0;
        }
        result[casteValue]++;
      }
      return result;
    }, {});
  }

  async calculateCountByCasteStats() {
    const results &#x3D; await this.prisma.beneficiary.findMany({
      where: {
        extras: {
          path: [&#x27;caste&#x27;],
          not: null || &#x27;&#x27;,
        },
      },
      select: {
        uuid: true,
        extras: true,
      },
    });

    const casteCounts &#x3D; this.countByCaste(results);
    const resultArray &#x3D; Object.keys(casteCounts).map((key) &#x3D;&gt; {
      return {
        id: key,
        count: casteCounts[key],
      };
    });
    return resultArray;
  }

  async calculateAllStats() {
    const [
      gender,
      bankedStatus,
      bankedStatusNew,
      internetStatus,
      phoneStatus,
      total,
      age,
      mapStats,
      phoneAvailabilityStats,
      vulnerabilityCountStats,
      casteCountStats,
      phoneTypeStats,
      totalVendors
    ] &#x3D; await Promise.all([
      this.calculateGenderStats(),
      this.calculateBankedStatusStats(),
      this.calculateBankedStatusStatsNew(),
      this.calculateInternetStatusStats(),
      this.calculatePhoneStatusStats(),
      this.totalBeneficiaries(),
      this.calculateAgeStats(),
      this.calculateMapStats(),
      this.calculatePhoneAvailabilityStats(),
      this.calculateVulnerabilityCountStats(),
      this.calculateCountByCasteStats(),
      this.calculatePhoneTypeStats(),
      this.totalVendors()
    ]);


    return {
      gender,
      bankedStatus,
      bankedStatusNew,
      internetStatus,
      phoneStatus,
      total,
      age,
      mapStats,
      phoneAvailabilityStats,
      vulnerabilityCountStats,
      casteCountStats,
      phoneTypeStats,
      totalVendors
    };
  }
  async calculateProjectStats(projectUuid: string) {

    const [gender, bankedStatus, internetStatus, phoneStatus, total, age, totalVendors] &#x3D;
      await Promise.all([
        this.calculateGenderStats(projectUuid),
        this.calculateBankedStatusStats(projectUuid),
        this.calculateInternetStatusStats(projectUuid),
        this.calculatePhoneStatusStats(projectUuid),
        this.totalBeneficiaries(projectUuid),
        this.calculateAgeStats(projectUuid),
        this.totalVendors(projectUuid),
      ]);

    return {
      gender,
      bankedStatus,
      internetStatus,
      phoneStatus,
      total,
      age,
      totalVendors,

    };
  }

  async getAllStats(group &#x3D; &#x27;beneficiary&#x27;) {
    return this.statsService.getByGroup(group, {
      name: true,
      data: true,
    });
  }

  async calculateRangedAge(ages: any) {
    let range &#x3D; [
      { id: &#x27;0-20&#x27;, count: 0 },
      { id: &#x27;20-40&#x27;, count: 0 },
      { id: &#x27;40-60&#x27;, count: 0 },
      { id: &#x27;60+&#x27;, count: 0 },
    ];
    ages.map((age) &#x3D;&gt; {
      if (age.id &gt;&#x3D; 0 &amp;&amp; age.id &lt;&#x3D; 20) {
        range[0].count &#x3D; range[0].count + age.count;
      }
      if (age.id &gt; 20 &amp;&amp; age.id &lt;&#x3D; 40) {
        range[1].count &#x3D; range[1].count + age.count;
      }
      if (age.id &gt; 40 &amp;&amp; age.id &lt;&#x3D; 60) {
        range[2].count &#x3D; range[2].count + age.count;
      }
      if (age.id &gt; 60) {
        range[3].count &#x3D; range[3].count + age.count;
      }
    });

    return range;
  }

  async saveAllStats(projectUuid?: string) {
    const {
      gender,
      bankedStatus,
      bankedStatusNew,
      internetStatus,
      phoneStatus,
      total,
      age,
      mapStats,
      phoneAvailabilityStats,
      vulnerabilityCountStats,
      casteCountStats,
      phoneTypeStats,
      totalVendors
    } &#x3D; await this.calculateAllStats();

    const rangedAge &#x3D; await this.calculateRangedAge(age);

    await Promise.all([
      this.statsService.save({
        name: &#x27;beneficiary_total&#x27;,
        data: total,
        group: &#x27;beneficiary&#x27;,
      }),
      this.statsService.save({
        name: &#x27;beneficiary_gender&#x27;,
        data: gender,
        group: &#x27;beneficiary&#x27;,
      }),
      this.statsService.save({
        name: &#x27;beneficiary_bankedStatus&#x27;,
        data: bankedStatus,
        group: &#x27;beneficiary&#x27;,
      }),
      this.statsService.save({
        name: &#x27;beneficiary_bankedStatus_new&#x27;,
        data: bankedStatusNew,
        group: &#x27;beneficiary&#x27;,
      }),
      this.statsService.save({
        name: &#x27;beneficiary_internetStatus&#x27;,
        data: internetStatus,
        group: &#x27;beneficiary&#x27;,
      }),
      this.statsService.save({
        name: &#x27;beneficiary_phoneStatus&#x27;,
        data: phoneStatus,
        group: &#x27;beneficiary&#x27;,
      }),
      this.statsService.save({
        name: &#x27;beneficiary_age_range&#x27;,
        data: rangedAge,
        group: &#x27;beneficiary&#x27;,
      }),
      this.statsService.save({
        name: &#x27;beneficiary_map_stats&#x27;,
        data: mapStats,
        group: &#x27;beneficiary&#x27;,
      }),
      this.statsService.save({
        name: &#x27;beneficiary_phone_availability_stats&#x27;,
        data: phoneAvailabilityStats,
        group: &#x27;beneficiary&#x27;,
      }),
      this.statsService.save({
        name: &#x27;beneficiary_vulnerability_count_stats&#x27;,
        data: vulnerabilityCountStats,
        group: &#x27;beneficiary&#x27;,
      }),
      this.statsService.save({
        name: &#x27;beneficiary_caste_count_stats&#x27;,
        data: casteCountStats,
        group: &#x27;beneficiary&#x27;,
      }),
      this.statsService.save({
        name: &#x27;beneficiary_phone_type_stats&#x27;,
        data: phoneTypeStats,
        group: &#x27;beneficiary&#x27;,
      }),
      this.statsService.save({
        name: &#x27;vendor_total&#x27;,
        data: totalVendors,
        group: &#x27;vendor&#x27;
      })
    ]);
    if (projectUuid) {
      const { gender, bankedStatus, internetStatus, phoneStatus, total, age, totalVendors } &#x3D;
        await this.calculateProjectStats(projectUuid);
      const rangedAge &#x3D; await this.calculateRangedAge(age);
      await Promise.all([
        this.statsService.save({
          name: &#x27;beneficiary_total&#x27;,
          data: total,
          group: projectUuid,
        }),
        this.statsService.save({
          name: &#x27;beneficiary_gender&#x27;,
          data: gender,
          group: projectUuid,
        }),
        this.statsService.save({
          name: &#x27;beneficiary_bankedStatus&#x27;,
          data: bankedStatus,
          group: projectUuid,
        }),
        this.statsService.save({
          name: &#x27;beneficiary_internetStatus&#x27;,
          data: internetStatus,
          group: projectUuid,
        }),
        this.statsService.save({
          name: &#x27;beneficiary_phoneStatus&#x27;,
          data: phoneStatus,
          group: projectUuid,
        }),
        this.statsService.save({
          name: &#x27;beneficiary_age_range&#x27;,
          data: rangedAge,
          group: projectUuid,
        }),
        this.statsService.save({
          name: &#x27;vendor_total&#x27;,
          data: totalVendors,
          group: projectUuid
        }),
        //PROJECT VOUCHER SHOULD BE CALCUATED IN PROJECT
        // this.statsService.save({
        //   name: &#x27;voucher_total&#x27;,
        //   data: await this.getTotalVoucher(),
        //   group: projectUuid
        // })
      ]);


      const projectStats &#x3D; await this.client.send({ cmd: &quot;rahat.jobs.reporting.list&quot;, uuid: projectUuid }, {})
        .pipe(timeout(MS_TIMEOUT)).toPromise();

      projectStats.forEach((stat) &#x3D;&gt; {
        this.statsService.save({
          name: stat.name,
          data: stat.data,
          group: projectUuid
        })
      })
    }

    return { gender, bankedStatus, internetStatus, phoneStatus, total };
  }
}

</code></pre>
    </div>

</div>













                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'BeneficiaryStatService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
