meta {
  name: password-register
  type: http
  seq: 1
}

post {
  url: {{url}}/vendors/password-register
  body: json
  auth: bearer
}

auth:bearer {
  token: {{access_token}}
}

body:json {
  {
    "name": "John Vendor",
    "service": "USERNAME",
    "email": "vendor@example.com",
    "phone": "+1234567890",
    "wallet": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
    "authWallet": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
    "extras": {
      "isVendor": true
    }
  }
}

assert {
  res.status: eq 201
  res.body.success: eq true
  res.body.data: isJson
}

script:post-response {
  const responseData = res.getBody();
  if (responseData.data?.credentials) {
    console.log('Vendor Credentials:');
    console.log('Username:', responseData.data.credentials.username);
    console.log('Temp Password:', responseData.data.credentials.tempPassword);
  }
}

tests {
  test('should register vendor with auto-generated password', async () => {
    const responseData = res.getBody().data;
    expect(responseData).to.have.property('credentials');
    expect(responseData.credentials).to.have.property('username');
    expect(responseData.credentials).to.have.property('tempPassword');
    expect(responseData).to.have.property('message');
  });
  
  test('should include signup data', async () => {
    const responseData = res.getBody().data;
    expect(responseData).to.have.property('signup');
    expect(responseData.signup).to.have.property('status');
  });
}

docs {
  # Vendor Password Registration
  
  This endpoint registers a new vendor with auto-generated username and password.
  
  ## Auto-Generated Credentials:
  - Username: Generated from vendor name (e.g., "john_vendor_1234")
  - Password: Secure random password (12 characters)
  
  ## Process:
  1. Admin calls this endpoint with vendor details
  2. System generates username and password
  3. Vendor is registered with VENDOR role
  4. Credentials are returned to admin
  5. Admin shares credentials with vendor securely
  
  ## Vendor Login:
  Vendor can login using the credentials at `/v1/auth/login/password` endpoint
}
