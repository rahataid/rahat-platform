// This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
// If a copy of the MPL was not distributed with this file, You can obtain one at http://mozilla.org/MPL/2.0/.
const VULNERABILITY_FIELD = {
  HOW_MANY_LACTATING: 'if_yes_how_many_lactating',
  HOW_MANY_PREGNANT: 'if_yes_how_many_pregnant',
  TYPE_OF_SSA_1: 'type_of_ssa_1',
  TYPE_OF_SSA_2: 'type_of_ssa_2',
  TYPE_OF_SSA_3: 'type_of_ssa_3',
};

const {
  TYPE_OF_SSA_1,
  TYPE_OF_SSA_2,
  TYPE_OF_SSA_3,
  HOW_MANY_LACTATING,
  HOW_MANY_PREGNANT,
} = VULNERABILITY_FIELD;

export const mapVulnerabilityStatusCount = (data: any[]) => {
  const myData: Record<string, number> = {};

  const incrementCount = (key: string, count = 1) => {
    if (key) {
      myData[key] = (myData[key] || 0) + count;
    }
  }

  for (const d of data) {
    const extras = d?.extras ?? {};

    incrementCount('Lactating', +extras[HOW_MANY_LACTATING] || 0)
    incrementCount('Pregnant', +extras[HOW_MANY_PREGNANT] || 0)


    incrementCount(extras[TYPE_OF_SSA_1])
    incrementCount(extras[TYPE_OF_SSA_2])
    incrementCount(extras[TYPE_OF_SSA_3])
  }
  return myData
};
